# Self_Assembly
Smulation code for the paper "The time complexity of self-assembly" in C++


Self_Assembly has been created by Florian Gartner from 2017 to 2019 and provides the C++ code to simulate the self-assembly of macromolecular structures using four different control scenarios (activation scenario, dimerization scenario, reversible binding scenario and Just-in-sequence scenario). The code has been used for all simulations performed for the paper "The time complexity of self-assembly" by Florian Gartner, Isabella Graf and Erwin Frey. The simulation itself and all parameters are implemented in alignment with the model described in detail in the paper, so it is advised to read the paper first in detail. Here we describe how to use the code. For further questions please contact F.Gartner@physik.uni-muenchen.de or frey@lmu.de


All parameters must be set before compiling the code. If parameters are changed the code must be recompiled. The parameters for the rate constants and control parameters like activation rate, dimerization rate, etc. are defined in main.cpp at the top. All parameters are explained in the code (see comments in the code). Furthermore, the more general settings must be defined in System.hpp at the top. Please choose first the scenario (0,1,2,3) that is to be simulated and then the dimensionality (1,2 or 3) of the target structure. Afterwards you can choose if structures are simulated with periodic or open boundaries, in which way the particles are provided in the activation scenario and whether or not the system should be homogeneous (distinguishable particle species) or homogeneous (single particle species; all monomers are indistinguishable), which might be useful, in particular, for the activation scenario to avoid stochastic effects (see the paper) and for the reversible binding scenario (as it allows to detect kinetic traps more efficiently in the reversible binding scenario). Further settings concern a maximum number of Gillespie steps that are performed, or a maximum time simulated. Moreover, the settings for the Just-in-sequence scenario can be set (for example whether or not non-stoichiometric concentrations for the various species should be used and the standard deviation of particles in each batch due to stochastic fluctuations (see paper)). All settings are explained in detail in the comments. 


The program provides three basic functions:
- Run_Simulation(), which allow to perform the simulation of a single parameter setting (averaged over stat independent runs, where stat is fixed in the parameter settings); 
- ParameterSweep(), which allows to perform a parameter sweep over the control parameter of the respective scenario. In tthis case, the value for the control parameter fixed at the top of main.cpp is ignored and the range of parameter values that is sweeped is fixed in the vector 'parameter_vector', which is defined in the function ParameterSweep(). parameter_vector has to be defined appropriately by hand in ParameterSweep(). If the putative parameter exponent and parameter value for a structure of size S=100 are already known, this knowledge can be used to center the range around the optimal value (see interface in ParameterSweep()). The output prints a vector T90, T50 (average time required to achieve 90% or 50% yield) and yield (average final yield) which can be copied and plotted conveniently against the parameter vector 'para' in any specialized software. A value -1 in T90 or T50 indicates that a yield of 90% or 50% could not be achieved for the respective parameter value before the final state was arrived or the maximum number of Gillespie steps or the maximum simulation time was exceeded. The output furthermore shows a vector 'time', giving the final time that was simulated on average for each parameter value and the variance in the measured yield between individual runs (which can be changed to give the variance in T90 in System.hpp). In order to parallelize the simulations for the different parameter values un-comment the macro PARALLELIZE in Preliminary.hpp (PARALLELIZE can not be used for RUN_Simulation()).
- Hyper_Sweep(): In order to perform a parameter sweep in the control parameter for different sizes of the target structure, which is necessary to determine the parameter- and time complexity exponent, the function Hyper_Sweep() can be used. For each system size, parameters like the particle number N or the statistics stat or maximum number of Gillespie steps can also be chosen individually, which means that the respective parameter settings defined on top of System.hpp are ignored. Hyper_Sweep() produces an output which can be copied directly to matlab and allows for the convenient determination of the exponents (however, it must always be controlled manually if the simulated parameter ranges were chosen adequately and cover the minimum of the assembly time).
The desired function has to be chosen in the main function by commenting the two other functions out.


The current default settings simulate the dimerization scenario for two-dimensional target structures. The default dimerization rate mu is such that a final yield slightly smaller than 90% is achieved when running the simulation with RunSimulation() and the assembly time T90 is accordingly outputted as -1. Slightly decrease the dimerization rate in order to achieve a yield larger or equal 90% or perform a parameter sweep with ParameterSweep() over a larger parameter range in order to find the minimal assembly time. Afterwards explore the behavior of the other scenarios by changing SCENARIO in System.hpp and adopt the parameter settings accordingly. Note that the activation rate and detachment parameter should always increase proportional to N, and Delta_T (which determines the time interval between subsequent batches in the Jis scenario) should depend inversely proportional on N in order to obtain the same bahavior of the system when N is altered (best practise is therefore to declare these rates always with a factor of N accordingly).  
